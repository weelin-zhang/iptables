==================================================iptables命令介绍:

iptables -t table 命令 chain rules -j target


table可以是filter,nat,mangle 默认是filter

命令:
-P 或 --policy  定义默认策略(ACCEPT/DROP)
[root@zwj iptables]# iptables -L
Chain INPUT (policy ACCEPT)
target     prot opt source               destination

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination
[root@zwj iptables]#
[root@zwj iptables]#
[root@zwj iptables]#
[root@zwj iptables]#
[root@zwj iptables]#
[root@zwj iptables]# iptables -t filter --policy  FORWARD DROP
[root@zwj iptables]# iptables -L
Chain INPUT (policy ACCEPT)
target     prot opt source               destination

Chain FORWARD (policy DROP)
target     prot opt source               destination

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination

-A 或 --append  在规则列表里最后追加一条规则



-I 或 --insert  在制定位置插入一条规则
#禁止ping
[root@zwj iptables]# iptables -t filter -I INPUT -p icmp -j DROP
[root@zwj iptables]#
[root@zwj iptables]# iptables -L
Chain INPUT (policy ACCEPT)
target     prot opt source               destination
DROP       icmp --  anywhere             anywhere

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination


-D 或 --delete  删除一条规则
eg: iptables -t filter -D INPUT 2 


-R 或 --replace 替换一条规则
eg: iptables -t filter -R INPUT 2 -p icmp -j DROP

-F 或  --flush 删除所有规则
eg: iptables -t filter -F INPUT #清楚filter表，INPUT链的规则
eg: iptables -t filter -F       #清除filter表左右的链的规则

==================================================iptables匹配选项

-i或--in-interface 制定数据包从哪一个网络接口进入，入ppp0,eth0,eth1
eg:iptables -t filter I INPUT -p icmp -i eth1 -j DROP    #使路由服务器的eth1 ping不通


-o或--out-interface
-p或--protocol 协议类型 制定数据包匹配的协议，tcp,udp,icmp
-s或--source 制定数据匹配的原地址
eg:iptables -t filter -I FORWARD -p tcp -s 192.168.80.123/32 -d 192.168.10.123/32 --dport 3389 -j DROP  #路由服务器禁止192.168.80.123/32 通过3389端口远程登录192.168.10.123/32
eg: iptables -t filter -I FORWARD -s 192.168.80.0/24 -d 192.168.10.0/24
#会让上面的失效

-d或--destination 制定数据匹配的目的地址
--sport 源端口号，指定数据包匹配的源端口号，可以使用"起始端口号:结束端口号"的格式制定一个范围的端口
--dport 目标端口号，指定数据包匹配的目标端口号，可以使用"起始端口号:结束端口号"的格式制定一个范围的端口





